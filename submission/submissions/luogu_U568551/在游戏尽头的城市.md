# 在游戏尽头的城市

## 题目描述

你成功在 $x=114，y=514，z=23$ 的地方找到了一个 $\color{purple}末地城$，门口的两只 $\color{purple}潜影贝$ 发射的漂浮子弹使你差点招架不住，但幸好屋檐挡住了你，所以你没有飞到空中。

所以你准备谨慎行事。

$\color{purple}末地城$ 里有一段像这样的楼梯，这挺高的啊。

![](https://cdn.luogu.com.cn/upload/image_hosting/nxb9yfwm.png)

这里是高塔内部的结构，这一段路是通向宝箱的必经之路。

宝箱里有 $\color{00BFFF}钻石$，$\color{3CB371}绿宝石$，$\color{FFD700}黄金$ 与 $\color{00BFFF}各\color{3CB371}种\color{FFD700}武\color{FFD700}器\color{00BFFF}装\color{3CB371}备$ 等一众财富，还有只有在这里到达的 $\color{purple}末地船$ 能拿到的 $鞘翅$，但是这段路一场艰险。

你，也就是 Steve，给所有的 $n$ 只 $\color{purple}潜影贝$ 每只都编了个数字，从下向上数的第 $i$ 只数字为 $a_i$。

你想与这些 $\color{purple}潜影贝$ 玩 $m$ 次游戏，顺便了解他们的情况。

每次游戏你会选择一个区间 $[l,r]$，并进行询问。

定义**发射导弹**的操作是随便选择一个正整数 $d$，使所有 $x\in P$ 的满足 $d\mid x$ 的数变为 $x-d$。

MoonCake2011 的描述：定义 $\operatorname{invisibility}(T)$ 为对集合 $P=\{a_x\}(x\in T)$ **至少**做 $\operatorname{invisibility}(T)$ 次**发射导弹**的操作，使 $P$ 里的数全部**非正**。

wzx7117 的描述：可以发现，对集合 $P=\{a_x\}(x\in T)$ 做若干次**发射导弹**的操作，可以使 $P$ 里的数全部**非正**。定义 $\operatorname{invisibility}(T)$ 为次数的最小值。

对于集合 $S=\{l,l+1,\dots,r-1,r\}$，我们需要求 $\sum_{T\subseteq S} \operatorname{invisibility}(T)\bmod 20090517$。

因为你没有“床岩石”，所以你在此题不能拥有创造理赔，必须**强制在线**。

## 输入格式

第一行两个整数 $n$，$m$。

第二行 $n$ 个整数，表示 $a_i$。

接下来 $m$ 行，每行两个数 $l'$ 和 $r'$。

设上一个答案为 $lans$，最开始 $lans=0$。

真实的 $l=l'\bigoplus lans,r=r'\bigoplus lans$。

## 输出格式

输出 $m$ 行，每行一个数，表示答案。

## 提示

### 数据范围

|测试点编号|数据范围|特殊性质|
|---|---|---|
|#1|$1\le n,m,a_i\le 6$|你被潜影贝导弹打了，获得了飘浮 I 效果|
|#2,#3|$1\le n,m,a_i\le 20$|Zhl 喜欢曲奇，如果 Zhl 是鹦鹉......|
|#4,#5,#6|$1\le n,m\le 10^3$|$a_i$ 不全相等|
|#7~#11|$1\le n,m,a_i\le 5\times 10^4$|你猜 $a_i$ 满足什么性质|
|#12|$1\le n,m\le 10^5$|$a_i$ 全部相等|
|#13,#14|$1\le n,m\le 10^5$|$1\le a_i\le 10^3$|
|#15,#16|$1\le n,m\le 10^5$|$l,r$ 均单调不降|
|#17~#20|$1\le n,m\le 10^5$|毛 \* \* 没来，所以不用逃|

对于 $100\%$ 的数据，$1\le n,m,a_i\le 10^5$，$l\le r$。

~~对于 $0\%$ 的数据，猫冥症听到自己被几餐了，所以锅粽粑 zhl 拿来让他解决 QMR 问题，所以来看个[顺天的](https://zh.minecraft.wiki)。~~

### 样例解释

请自行解密样例，然后可以注意到暴力枚举易证得答案是正确的。

### 题目信息

Idea：LBY，Solution：LBY，Code：LBY，Data：WZX

时间空间限制：3s/512MB

输入输出文件名：end_city.in/end_city.out

### 闲话

Advertisement：在今天 17\:00 之前，第一个最先发现此题至少六个关于 MC 的隐藏的题面里的彩蛋就可以获得 LBY 的一瓶水。

Question：基岩版困难生存无作弊 MC 里血量最高的生物是？

Notice：暑假线上联机 MC 吗？

## 时空限制

时间限制: 3000 ms
内存限制: 512 MB
