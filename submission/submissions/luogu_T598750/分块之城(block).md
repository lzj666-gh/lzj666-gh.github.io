# 分块之城(block)

## 题目描述

城市的规划在城市建设中是个大问题。

不幸的是，很多城市在开始建设的时候并没有很好的规划，城市规模扩大之后规划不合理的问题就开始显现。

而这座名为 Block 的城市设想了这样的一个规划方案:

![](https://cdn.luogu.com.cn/upload/image_hosting/ko29hmxs.png)

将边长为 $n \times m(n=p^2,m=q^2,p,q \in N_+)$ 的城市分割为 $\sqrt n \times \sqrt m$ 个区块，每个区块大小相等。

你需要支持两种操作：

- 将点 $(i,j)$ 向某一个方向（上下左右）并入该方向的下一个区块中（若该方向没有区块，则将忽略本次操作）（出题人知道自己讲不清楚，所以他配备了足够清晰的[样例 $1$ 解释](‪\\192.168.110.5\shareeee(110_5)\2个人资料暂存在这儿\lies.mp4))

- 给定区块编号，求该区块占地面积。

## 输入格式

第一行三个整数 $n,m,t$。$t$ 为询问数。

接下来 $t$ 行每行若干个整数，描述一个操作。

`1 x y way` 表示这是修改操作。将 $(x,y)$ 向 `way` 方向并入该方向的下一个区块。

- 若 `way` 为 $L$ , 则将 $(x,y)$ 向左方向并入该方向的下一个区块。
- 若 `way` 为 $R$ , 则将 $(x,y)$ 向右方向并入该方向的下一个区块。
- 若 `way` 为 $U$ , 则将 $(x,y)$ 向上方向并入该方向的下一个区块。
- 若 `way` 为 $D$ , 则将 $(x,y)$ 向下方向并入该方向的下一个区块。

`2 k` 表示这是修改操作，查询区块编号为 $k$ 的区域所占面积。区块编号参考[样例解释](‪\\192.168.110.5\shareeee(110_5)\2个人资料暂存在这儿\lies.mp4)。

## 输出格式

对于每一个 $2$ 操作，输出它的答案，每个询问答案各占一行。

## 提示

### 样例解释#1：

蓝色、绿色、黄色、红色分别表示区块 $1,2,3,4$。

最初：

![](https://cdn.luogu.com.cn/upload/image_hosting/dpbfe953.png)

第一步后：

![](https://cdn.luogu.com.cn/upload/image_hosting/6qxmrw9a.png)

第二步后：

![](https://cdn.luogu.com.cn/upload/image_hosting/33idg8yf.png)

第三步后：

![](https://cdn.luogu.com.cn/upload/image_hosting/dx5zfl7g.png)
### 数据范围

由于出题人觉得之前总是没人打暴力，所以这次暴力分很足。

以及出题人想看有没有人暴力卡常过测试点 $8$ 。


令 $a=\sqrt n,b=\sqrt m$ 

|  测试点编号  |  $a$   |       $b$        |           $q$            |      特殊性质      |
| :----------: | :----: | :--------------: | :----------------------: | :----------------: |
|  $1 \sim 8$  | $a=2*id$ | $b=id \times 30$ |   $q=id^2 \times 2000$   | $id$ 为测试点编号  |
| $9 \sim 10$  | $a=1$  |     $b=256$      |        $q=490000$        |                    |
| $11 \sim 14$ | $a=16$ |     $b=256$      |        $q=490000$        | 操作一方向只有左右 |
| $15 \sim 18$ | $a=16$ |     $b=128$      |        $q=490000$        |                    |
| $19 \sim 25$ | $a=16$ |   **$b=256$**    | $q=(id-18) \times 70000$ | $id$ 为测试点编号  |

对于所有数据, $1 \le a \le 16,1 \le b \le 256,q \le 490000$

## 时空限制

时间限制: 1500 ms
内存限制: 512 MB
